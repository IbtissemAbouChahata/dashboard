<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width,  initial-scale=1.0" />
      <title>Dashboard</title>
      <!--bootstrap -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
      <!--chart.js-->
      <!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

      {% load static %}
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/5.0.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.0.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        body {
            min-height: 100vh;
            min-height: -webkit-fill-available;
        }
        html {
            height: -webkit-fill-available;
        }
        main {
            height: 100vh;
            height: -webkit-fill-available;
            max-height: 100vh;
            overflow-x: auto;
            overflow-y: hidden;
        }
        .dropdown-toggle { outline: 0; }
        .btn-toggle {
            padding: .25rem .5rem;
            font-weight: 600;
            color: var(--bs-emphasis-color);
            background-color: transparent;
        }
        .btn-toggle:hover,
        .btn-toggle:focus {
            color: rgba(var(--bs-emphasis-color-rgb), .85);
            background-color: var(--bs-tertiary-bg);
        }
        .btn-toggle::before {
            width: 1.25em;
            line-height: 0;
            content: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='rgba%280,0,0,.5%29' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 14l6-6-6-6'/%3e%3c/svg%3e");
            transition: transform .35s ease;
            transform-origin: .5em 50%;
        }
        [data-bs-theme="dark"] .btn-toggle::before {
            content: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='rgba%28255,255,255,.5%29' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 14l6-6-6-6'/%3e%3c/svg%3e");
        }
        .btn-toggle[aria-expanded="true"] {
            color: rgba(var(--bs-emphasis-color-rgb), .85);
        }
        .btn-toggle[aria-expanded="true"]::before {
            transform: rotate(90deg);
        }
        .btn-toggle-nav a {
            padding: .1875rem .5rem;
            margin-top: .125rem;
            margin-left: 1.25rem;
        }
        .btn-toggle-nav a:hover,
        .btn-toggle-nav a:focus {
            background-color: var(--bs-tertiary-bg);
        }
        .text-small {
            font-size: 85%;
        }
        .dropdown-toggle:not(:focus) {
            outline: 0;
        }
        .scrollarea {
            overflow-y: auto;
        }
        .bd-mode-toggle {
            z-index: 1500;
        }
        .bd-mode-toggle .dropdown-menu .active .bi {
            display: block !important;
        }
        .imgcontainer {
            text-align:center;
            margin-bottom: 15px;
        }
        .avatar {
            width: 50px;
            border-radius: 50%;
        }
        .navbar {
            background-color: rgba(66, 114, 197);
        }
        .btn-custom {
            background-color: #e68900;
            border-color: #e68900;}

      </style>
      <script src="https://cdnjs.com/libraries/Chart.js"></script>
      <!-- data tables-->
       <link href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css" rel="stylesheet" type="text/css">
       <script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest" type="text/javascript"></script>
       <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="b-example-divider"></div>

<svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="bootstrap" viewBox="0 0 118 94">
    <title>Bootstrap</title>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M24.509 0c-6.733 0-11.715 5.893-11.492 12.284.214 6.14-.064 14.092-2.066 20.577C8.943 39.365 5.547 43.485 0 44.014v5.972c5.547.529 8.943 4.649 10.951 11.153 2.002 6.485 2.28 14.437 2.066 20.577C12.794 88.106 17.776 94 24.51 94H93.5c6.733 0 11.714-5.893 11.491-12.284-.214-6.14.064-14.092 2.066-20.577 2.009-6.504 5.396-10.624 10.943-11.153v-5.972c-5.547-.529-8.934-4.649-10.943-11.153-2.002-6.484-2.28-14.437-2.066-20.577C105.214 5.894 100.233 0 93.5 0H24.508zM80 57.863C80 66.663 73.436 72 62.543 72H44a2 2 0 01-2-2V24a2 2 0 012-2h18.437c9.083 0 15.044 4.92 15.044 12.474 0 5.302-4.01 10.049-9.119 10.88v.277C75.317 46.394 80 51.21 80 57.863zM60.521 28.34H49.948v14.934h8.905c6.884 0 10.68-2.772 10.68-7.727 0-4.643-3.264-7.207-9.012-7.207zM49.948 49.2v16.458H60.91c7.167 0 10.964-2.876 10.964-8.281 0-5.406-3.903-8.178-11.425-8.178H49.948z"></path>
  </symbol>
  <symbol id="home" viewBox="0 0 16 16">
    <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z"/>
  </symbol>
  <symbol id="speedometer2" viewBox="0 0 16 16">
    <path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4zM3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.389.389 0 0 0-.029-.518z"/>
    <path fill-rule="evenodd" d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A7.988 7.988 0 0 1 0 10zm8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3z"/>
  </symbol>
  <symbol id="table" viewBox="0 0 16 16">
    <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 2h-4v3h4V4zm0 4h-4v3h4V8zm0 4h-4v3h3a1 1 0 0 0 1-1v-2zm-5 3v-3H6v3h4zm-5 0v-3H1v2a1 1 0 0 0 1 1h3zm-4-4h4V8H1v3zm0-4h4V4H1v3zm5-3v3h4V4H6zm4 4H6v3h4V8z"/>
  </symbol>
  <symbol id="people-circle" viewBox="0 0 16 16">
    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
    <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
  </symbol>
  <symbol id="grid" viewBox="0 0 16 16">
    <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
  </symbol>
</svg>
<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container-fluid">
      <a class="navbar-brand" href="#">LightMyWay</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                  <a class="nav-link active" aria-current="page" href="#">Admin</a>
              </li>
              <li class="nav-item">
                  <a class="nav-link" href="#">Settings&nbsp;</a>
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Services
                </a>
                <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#addValueModal">Add values</a></li>
                  <li><a class="dropdown-item" href="#">Another service</a></li>
                  <li><a class="dropdown-item" href="#">More services</a></li>
                </ul>
              </li>
              
              <li class="nav-item">
                  <a class="nav-link" href="{% url 'home' %}" role="button">Log Out</a>
              </li>
             

          </ul>
      </div>
  </div>
</nav>
    <table  style="width:100%">
        <td class="d-flex" >
            <div class="d-flex flex-column flex-shrink-0 p-3 bg-body-tertiary" style="width: 280px;">
                <ul class="nav nav-pills flex-column mb-auto">
                  <li>
                    <a href="{% url 'home' %}" class="nav-link link-body-emphasis">
                      <svg class="bi pe-none me-2" width="16" height="16"><use xlink:href="#home"/></svg>
                      Home
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="#" class="nav-link active" aria-current="page">
                      <svg class="bi pe-none me-2" width="16" height="16"><use xlink:href="#speedometer2"/></svg>
                      Dashboard
                    </a>
                  </li>
                  <li>
                    <a href="{% url 'detection' %}" class="nav-link link-body-emphasis">
                      <svg class="bi pe-none me-2" width="16" height="16"><use xlink:href="#speedometer2"/></svg>
                      Defect detection
                    </a>
                  </li>
                  <li>
                    <div class="card">
                        <div class="card-header">
                            Latest Sensor Data
                        </div>
                        <div class="card-body">
                            <p>Timestamp: <span id="timestamp"></span>&nbsp;</p>
                            <p>Temperature: <span id="temperature"></span>&nbsp;°C</p>
                            <p>Humidity: <span id="humidity"></span>&nbsp;%</p>
                             <p>Voltage: <span id="voltage"></span>&nbsp;V</p>
                            <p>Current: <span id="current"></span>&nbsp;A</p>
                        <p>Luminosity: <span id="luminosity"></span>&nbsp;lux</p>
                        </div>
                    </div>
                  </li>
                </ul>
        </td>
        <td>
    <div class="container"></div>
      <div class="row">
      <div class="col-md-6">
        <canvas id="myChart"></canvas>
      </div>
      <div class="col-md-6">
        <canvas id="myChart2"></canvas>
      </div>
    </div>
    <div class="row">
        <div class="col-md-6">
          <canvas id="myChart1"></canvas>
        </div>
        <div class="col-md-6">
          <canvas id="myChart4"></canvas>
        </div>
      </div>
    </td>
</table>
<!-- Button to Open the Modal -->
  
  <!-- The Modal -->
  <div class="modal fade" id="addValueModal" tabindex="-1" aria-labelledby="addValueModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addValueModalLabel">Add Value</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <form id="addValueForm" method="post" action="{% url 'addvalue' %}">
                {% csrf_token %}
                <div class="mb-3">
                    <label for="Temperature" class="form-label">Temperature Value</label>
                    <input type="text" class="form-control" id="Temperature" name="Temperature" placeholder="Enter Temperature value" required>
                </div>
                <div class="mb-3">
                    <label for="Humidity" class="form-label">Humidity Value</label>
                    <input type="text" class="form-control" id="Humidity" name="Humidity" placeholder="Enter Humidity value" required>
                </div>
                <div class="mb-3">
                    <label for="Voltage" class="form-label">Voltage Value</label>
                    <input type="text" class="form-control" id="Voltage" name="Voltage" placeholder="Enter Voltage value" required>
                </div>
                <div class="mb-3">
                    <label for="Current" class="form-label">Current Value</label>
                    <input type="text" class="form-control" id="Current" name="Current" placeholder="Enter Current value" required>
                </div>
                <div class="mb-3">
                    <label for="Luminosity" class="form-label">Luminosity Value</label>
                    <input type="text" class="form-control" id="Luminosity" name="Luminosity" placeholder="Enter Luminosity value" required>
                </div>
                <div class="mb-3">
                    <label for="autoDate" class="form-label">Date</label>
                    <input type="text" class="form-control" id="autoDate" name="autoDate" readonly>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary" form="addValueForm">Add</button>
                  </div>
            </form>
            
      
    </div>
  </div>
  
</body>
<script>
    document.addEventListener("DOMContentLoaded", function() {
            // Access Django variables and assign them to JavaScript variables
            const labels = JSON.parse('{{ labels|escapejs }}');
        const values1 = JSON.parse('{{ values1|escapejs }}');
        const values2 = JSON.parse('{{ values2|escapejs }}');
        const values3 = JSON.parse('{{ values3|escapejs }}');
        const values4 = JSON.parse('{{ values4|escapejs }}');
        const values5 = JSON.parse('{{ values5|escapejs }}');

            // Use the values as needed
            console.log("Timestamp: ", timestamp);
            console.log("Temperature: ", temperature);
            console.log("Humidity: ", humidity);
            console.log("Voltage: ", voltage);
            console.log("Current: ", current);
            console.log("Luminosity: ", luminosity);

            // Example of updating HTML elements
            document.getElementById("timestamp").textContent = labels[labels.length-1];
            document.getElementById("temperature").textContent = values1[values1.length-1];
            document.getElementById("humidity").textContent = values2[values2.length-1];
            document.getElementById("voltage").textContent = values3[values3.length-1];
            document.getElementById("current").textContent = values4[values4.length-1];
            document.getElementById("luminosity").textContent = values5[values5.length-1];
        });

 document.getElementById('addValueModal').addEventListener('show.bs.modal', function (event) {
  // Function to increment the date and time
  function incrementDateAndTime(currentDate) {
    // Add 1 minute to the current time
    currentDate.setMinutes(currentDate.getMinutes() + 1);
    return currentDate;
  }

  // Get the current date and time
  let currentDate = new Date();
  
  // Increment the date and time
  currentDate = incrementDateAndTime(currentDate);

  // Format the date and time
  const date = currentDate.getFullYear() + '-' + 
               String(currentDate.getMonth() + 1).padStart(2, '0') + '-' + 
               String(currentDate.getDate()).padStart(2, '0');

  const time = String(currentDate.getHours()).padStart(2, '0') + ':' + 
               String(currentDate.getMinutes()).padStart(2, '0') + ':' + 
               String(currentDate.getSeconds()).padStart(2, '0');

  // Set the date and time in the input field
  document.getElementById('autoDate').value = date + ' ' + time;
});


  document.addEventListener('DOMContentLoaded', function() {
      // Retrieve the data from the context
      const labels = JSON.parse('{{ labels|escapejs }}');
        const values1 = JSON.parse('{{ values1|escapejs }}');
        const values2 = JSON.parse('{{ values2|escapejs }}');
        const values3 = JSON.parse('{{ values3|escapejs }}');
        const values4 = JSON.parse('{{ values4|escapejs }}');
        const values5 = JSON.parse('{{ values5|escapejs }}');
  
      // Chart 1
      const ctx = document.getElementById('myChart').getContext('2d');
      new Chart(ctx, {
          data: {
              labels: labels,
              datasets: [{
                  type: 'line',
                  label: 'Temperature',
                  data: values1,
                  backgroundColor: [
                      'rgba(255, 99, 132, 0.2)',
                      'rgba(255, 159, 64, 0.2)',
                      'rgba(255, 205, 86, 0.2)',
                      'rgba(75, 192, 192, 0.2)',
                      'rgba(54, 162, 235, 0.2)',
                      'rgba(153, 102, 255, 0.2)',
                      'rgba(201, 203, 207, 0.2)'
                  ],
                  borderColor: [
                      'rgb(255, 99, 132)',
                      'rgb(255, 159, 64)',
                      'rgb(255, 205, 86)',
                      'rgb(75, 192, 192)',
                      'rgb(54, 162, 235)',
                      'rgb(153, 102, 255)',
                      'rgb(201, 203, 207)'
                  ],
                  borderWidth: 1
              },
              {
                  type: 'line',
                  label: 'Humidity',
                  data: values2,
                  fill: false,
                  borderColor: 'rgb(75, 192, 192)',
                  tension: 0.1
              }]
          },
          options: {
              scales: {
                  y: {
                      beginAtZero: true
                  }
              }
          }
      });
  
      // Chart 2
      const ct3 = document.getElementById('myChart2').getContext('2d');
      new Chart(ct3, {
          type: 'line',
          data: {
              labels: labels,
              datasets: [{
                  label: 'Current',
                  data: values3,
                  fill: false,
                  backgroundColor: 'rgb(255, 99, 132)',
                  borderColor: 'rgb(255, 99, 132)',
                  tension: 0.1
              }]
          },
          options: {
              scales: {
                  y: {
                      beginAtZero: true
                  }
              }
          }
      });
  
      // Chart 3
      const ct4 = document.getElementById('myChart1').getContext('2d');
      new Chart(ct4, {
          type: 'line',
          data: {
              labels: labels,
              datasets: [{
                  label: 'Voltage',
                  data: values4,
                  fill: false,
                  borderColor: 'rgb(75, 192, 192)',
                  tension: 0.1
              }]
          },
          options: {
              scales: {
                  y: {
                      beginAtZero: true
                  }
              }
          }
      });
  
      // Chart 4
      const ct5 = document.getElementById('myChart4').getContext('2d');
      new Chart(ct5, {
          type: 'line',
          data: {
              labels: labels,
              datasets: [{
                  label: 'Luminosity',
                  data: values5,
                  fill: false,
                  borderColor: 'rgb(75, 192, 192)',
                  tension: 0.1
              }]
          },
          options: {
              scales: {
                  y: {
                      beginAtZero: true
                  }
              }
          }
      });
  });
  </script>
  
  
</html>